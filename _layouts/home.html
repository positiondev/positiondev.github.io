<!doctype html>

<html lang="en">
  <head>
    {% include head.html %}

    <https://cdnjs.cloudflare.com/ajax/libs/fetch/2.0.4/fetch.min.js>
  </head>

  <body>
    <header>
      {% include header.html %}
    </header>

    <nav>
      <ul>
          <li><a href="/">home</a></li>
          <li><a href="#clients">clients</a></li>
          <li><a href="#project-spotlight">project spotlight</a></li>
          <li><a href="#team">team</a></li>
          <li><a href="#contact">contact us</a></li>
      </ul>
    </nav>

    <hr />

    <main>

      <section class="mission">
        {{ page.content | markdownify }}
      </section>

      <hr />

      <section class="clients" id="clients">
        <h2>clients</h2>
        <ul>
          {% for client in site.data.clients %}
          <li>
            <img title="{{ client.name }} logo" src="/img/{{ client.image }}" />
            <h3><a href="{{ client.url }}" target="_blank" rel="noopener">{{ client.name }}</a></h3>
          </li>
          {% endfor %}
        </ul>
      </section>

      <hr />

      <section class="skills" id="skills">
        <h2>skills</h2>

        <p>We carefully pair high-end technology services to the requirements and
          reality of our clients' day to day operation. We study their needs and
          create unique systems and processes to ensure their objectives are met.</p>
        <ul>
          <li>Front and backend development</li>
          <li>Automated testing and deployment</li>
          <li>Ecommerce and fulfillment</li>
          <li>Legacy applications</li>
          <li>Technical strategy </li>
        </ul>

      </section>

      <hr />

      <section class="project" id="project-spotlight">
        <h2>project spotlight</h2>

        {% for testimonial in site.testimonials limit:1 %}
        <h3>{{ testimonial.client_name }} (<a href="{{ testimonial.project_url }}">{{ testimonial.project_name }}</a>)</h3>
        <blockquote>
          {{ testimonial.content | markdownify }}
        </blockquote>

        <div class="byline">â€“ {{ testimonial.person }}, {{ testimonial.title }}, {{ testimonial.client_name }}</div>
        {% endfor %}
      </section>

      <hr />

      <section class="team" id="team">
        <h2>team</h2>
        <ul>
            {% assign sorted = site.workers | sort: 'start_date' %}
            {% for worker in sorted %}
            <li>
              <h3>{{ worker.name }}</h3>

              <div>{{ worker.content | markdownify }}</div>
            </li>
            {% endfor %}
          </ul>
      </section>

      <hr />

      <section class="contact-us" id="contact-us">
        <h2>contact us</h2>

        <form id="contact-form"
              method="POST">
          <fieldset class="basic-data">
            <legend>basic data</legend>
            <label>
              name
              <input id="name" name="name">
            </label>

            <label>
              email
              <input id="email" name="email">
            </label>
          </fieldset>

          <fieldset class="interested">
            <legend>interested in:</legend>

            <label><input type="checkbox" name="interested-in" value="webdev" />
              web app development
            </label>
            <label><input type="checkbox" name="interested-in" value="legacy" />
              legacy software maintenance
            </label>
            <label><input type="checkbox" name="interested-in" value="strategy" />
              digital strategy
            </label>
            <label><input type="checkbox" name="interested-in" value="jobs" />
              jobs
            </label>
            <label><input type="checkbox" name="interested-in" value="collaboration" />
              collaboration
            </label>
            <label><input type="checkbox" name="interested-in" value="other">
              something else
            </label>
          </fieldset>

          <label class="tell-more">tell us more: <br />
            <textarea name="tell-us-more" rows="4"></textarea>
          </label>

          <fieldset class="heard-about">
            <legend>heard about position through:</legend>
              <label><input type="checkbox" name="heard-about-via" value="referral" />
                a referral
              </label>
              <label><input type="checkbox" name="heard-about-via" value="event"/>
                an event
              </label>
              <label><input type="checkbox" name="heard-about-via" value="search" />
                search
              </label>
              <label><input type="checkbox" name="heard-about-via" value="social"/>
                social media
              </label>
              <label><input type="checkbox" name="heard-about-via" value="other" />
                something else
              </label>
          </fieldset>

          <div class="button-wrapper">
            <input type="submit" value="send" />
          </div>
        </form>

        <div id="thank-you">
          <h3 id="thank-you-name">thank you</h3>

          <p>We'll get back to you shortly.</p>
        </div>

      </section>
    </main>

    <hr />

    <footer>
      {% include footer.html %}
    </footer>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-58668184-1', 'auto');
      ga('require', 'linkid', 'linkid.js');
      ga('send', 'pageview');

      (function() {
        const h2s = document.getElementsByTagName("h2")

        for (i = 0; i < h2s.length; i++) {

          h2s[i].className = "nothover";

          h2s[i].addEventListener("mouseover", function(e) {
            if (e.target) {
              e.target.className = "hover";
            }
          });

          h2s[i].addEventListener("mouseout", function(e) {
            if (e.target) {
              e.target.className = "nothover";
            }
          });
        }
      }())

    function postToAirtableViaGlitch(e) {
      e.preventDefault()
      var glitch = "https://airtable-post-proxy.glitch.me/api/contact";

      var form = document.getElementById("contact-form")

      const formData = new FormData(form);
      let jsonObject = {};

      for (const [key, value]  of formData.entries()) {
        if (jsonObject[key]) {
          var curVal = jsonObject[key];
          if (Array.isArray(curVal) && curVal.length > 1) {
            list = curVal;
          } else {
            list = [curVal];
          }
          list.push(value)
          jsonObject[key] = list;
        } else {
          jsonObject[key] = value;
        }
      }

      window.fetch(glitch, {
        method: "POST",
        body: JSON.stringify(jsonObject),
        headers: {
          'Accept': 'application/json',
          'Content-Type': 'application/json'
        }
      })

      document.getElementById("contact-form").style.display = "none";
      document.getElementById("thank-you").style.display = "block";
      document.getElementById("thank-you-name").innerHTML = "thank you, " + jsonObject['name'];
    }


    (function(){
       document.getElementById("contact-form").addEventListener("submit", postToAirtableViaGlitch)
    }())
    </script>
  </body>

</html>